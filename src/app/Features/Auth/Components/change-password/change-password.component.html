<div
  class="min-h-screen flex items-center justify-center bg-gradient-to-b from-slate-50 to-slate-100 dark:from-gray-900 dark:to-gray-800 py-8"
>
  <form
    [formGroup]="loginForm"
    (ngSubmit)="submit()"
    class="w-full max-w-md bg-white dark:bg-gray-900 dark:text-white p-6 sm:p-8 rounded-2xl shadow-lg rtl"
    dir="rtl"
    aria-labelledby="loginTitle"
  >
    <h1
      id="loginTitle"
      class="text-center text-2xl sm:text-3xl font-extrabold text-slate-800 dark:text-white mb-6"
    >
      تسجيل الدخول
    </h1>

    <!-- currentPassword -->
    <div class="mb-3">
      <label
        for="currentPassword"
        class="block text-sm font-medium text-slate-700 mb-2 dark:text-white"
        >كلمة السر الحالية</label
      >
      <p-inputGroup class="w-full">
        <p-inputGroupAddon
          class="bg-blue-50 border border-blue-200 rounded-l-md p-2 dark:bg-gray-800 dark:border-gray-700"
        >
          <i class="pi pi-lock text-slate-600 text-2xl dark:text-gray-400"></i>
        </p-inputGroupAddon>
        <input
          id="currentPassword"
          pPassword
          type="password"
          formControlName="currentPassword"
          placeholder="أدخل كلمة السر الحالية"
          class="w-full rounded-r-md p-3 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-300 text-base dark:bg-gray-900 dark:border-gray-700 dark:focus:ring-indigo-600"
          aria-describedby="currentPasswordError"
          [ngClass]="{
            'bg-green-200 border-green-500 dark:bg-green-900 dark:border-green-700':
              currentPassword.valid &&
              (currentPassword.dirty || currentPassword.touched),
            'bg-red-200 border-red-500 dark:bg-red-900 dark:border-red-700':
              currentPassword.invalid &&
              (currentPassword.dirty || currentPassword.touched)
          }"
          #currentPasswordInput
        />
        <p-inputGroupAddon
          class="bg-gray-50 border border-blue-200 rounded-l-md p-2 dark:bg-gray-800 dark:border-gray-700"
        >
          <button
            type="button"
            class="p-0"
            (click)="togglePassword('currentPassword')"
            [attr.aria-pressed]="visibility['currentPassword'] ? true : false"
            title="Toggle password visibility"
          >
            <i
              [hidden]="visibility['currentPassword']"
              class="pi pi-eye text-slate-600 text-2xl dark:text-gray-400"
            ></i>
            <i
              [hidden]="!visibility['currentPassword']"
              class="pi pi-eye-slash text-slate-600 text-2xl dark:text-gray-400"
            ></i>
          </button>
        </p-inputGroupAddon>
      </p-inputGroup>

      <!-- messages -->
      @if (currentPassword.touched || currentPassword.dirty) {

      <div class="mt-3">
        @if (currentPassword.hasError('required')) {
        <p-messages
          [value]="[
            { severity: 'error', summary: 'خطأ', detail: 'كلمة المرور مطلوبة' }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        } @if (newPassword.hasError('minlength')) {
        <p-messages
          [value]="[
            {
              severity: 'error',
              summary: 'خطأ',
              detail: 'يجب ألا تقل كلمة السر عن 6 أحرف'
            }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        }
      </div>
      }
    </div>

    <!-- newPassword -->
    <div class="mb-4">
      <label
        for="newPassword"
        class="block text-sm font-medium text-slate-700 mb-2 dark:text-white"
        >كلمة السر الجديدة</label
      >

      <p-inputGroup class="w-full">
        <p-inputGroupAddon
          class="bg-blue-50 border border-blue-200 rounded-l-md p-2 dark:bg-gray-800 dark:border-gray-700"
        >
          <i class="pi pi-lock text-slate-600 text-2xl dark:text-gray-400"></i>
        </p-inputGroupAddon>
        <input
          pPassword
          type="password"
          id="newPassword"
          formControlName="newPassword"
          placeholder="أدخل كلمة المرور الجديدة"
          class="w-9/12 p-3 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-300 text-base dark:bg-gray-900 dark:border-gray-700"
          aria-describedby="newPasswordError"
          [ngClass]="{
            'bg-green-200 border-green-500 dark:bg-green-900 dark:border-green-700':
              newPassword.valid && (newPassword.dirty || newPassword.touched),
            'bg-red-200 border-red-500 dark:bg-red-900 dark:border-red-700':
              newPassword.invalid && (newPassword.dirty || newPassword.touched)
          }"
          #newPasswordInput
        />
        <p-inputGroupAddon
          class="bg-gray-50 border border-blue-200 rounded-l-md p-2 dark:bg-gray-800 dark:border-gray-700"
        >
          <button
            type="button"
            class="p-0"
            (click)="togglePassword('newPassword')"
            title="Toggle password visibility"
          >
            <i
              [hidden]="visibility['newPassword']"
              class="pi pi-eye text-slate-600 text-2xl dark:text-gray-400"
            ></i>
            <i
              [hidden]="!visibility['newPassword']"
              class="pi pi-eye-slash text-slate-600 text-2xl dark:text-gray-400"
            ></i>
          </button>
        </p-inputGroupAddon>
      </p-inputGroup>

      @if (newPassword.touched || newPassword.dirty) {

      <div class="mt-3">
        @if (newPassword.hasError('required')) {
        <p-messages
          [value]="[
            { severity: 'error', summary: 'خطأ', detail: 'كلمة السر مطلوبة' }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        } @if (newPassword.hasError('minlength')) {
        <p-messages
          [value]="[
            {
              severity: 'error',
              summary: 'خطأ',
              detail: 'يجب ألا تقل كلمة السر عن 6 أحرف'
            }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        }
      </div>
      }
    </div>

    <div class="flex justify-center mt-6">
      <p-button
        type="submit"
        label="تغيير كلمة السر"
        [disabled]="loginForm.invalid"
        class="w-full sm:w-auto bg-gradient-to-r from-indigo-600 to-blue-600 dark:from-indigo-700 dark:to-blue-700 text-white dark:text-gray-300 font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition"
      ></p-button>
    </div>
  </form>
</div>
