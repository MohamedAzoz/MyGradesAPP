<!-- <div class="min-h-screen flex items-center justify-center bg-gray-50 py-8">
  <form
    [formGroup]="loginForm"
    (ngSubmit)="submit()"
    class="w-fit max-w-md sm:max-w-lg lg:max-w-xl bg-blue-200 p-6 sm:p-8 rounded-2xl shadow-2xl flex flex-col gap-6"
  >
    <h1 class="font-bold text-xl m-auto capitalize">Login form</h1>
  
    <p-inputGroup
      class="bg-blue-400 hover:bg-blue-500 border-2 border-blue-500 p-3 rounded-md"
    >
      <p-inputGroupAddon>
        <i class="pi pi-envelope"></i>
      </p-inputGroupAddon>
      <input
        pInputText
        formControlName="nationalId"
        placeholder="National ID"
        [autofocus]="true"
        class="w-full text-base border-2 border-blue-600 rounded-md p-2"
      />
    </p-inputGroup>
    <div class="flex flex-col">
      @if (nationalId.touched&& nationalId.dirty) { @if
      (nationalId.getError('required')) {
      <p-messages
        [value]="[
          {
            severity: 'error',
            summary: 'validation error',
            detail: 'National ID is required'
          }
        ]"
        [enableService]="false"
        [closable]="false"
      />
      } @if (nationalId.getError('pattern')) {
      <p-messages
        [value]="[
          {
            severity: 'error',
            summary: 'validation error',
            detail: 'National ID not valid'
          }
        ]"
        [enableService]="false"
        [closable]="false"
      />
      } }
    </div>

    <p-inputGroup
      class="bg-blue-400 hover:bg-blue-500 border-2 border-blue-500 rounded-md p-3"
    >
      <p-inputGroupAddon>
        <i class="pi pi-lock"></i>
      </p-inputGroupAddon>
      <input
        pInputText
        type="password"
        formControlName="password"
        placeholder="password"
        class="w-full text-base border-2 border-blue-600 rounded-md p-2"
      />
    </p-inputGroup>
    <div class="flex flex-col">
      @if (password.dirty && password.touched) { @if
      (password.getError('required')) {
      <p-messages
        [value]="[
          {
            severity: 'error',
            summary: 'error ',
            detail: 'password is required'
          }
        ]"
        [enableService]="false"
        [closable]="false"
      />
      } @if (password.getError('minlength')) {
      <p-messages
        [value]="[
          {
            severity: 'error',
            summary: 'validation error',
            detail: 'must be at least 6 char'
          }
        ]"
        [enableService]="false"
        [closable]="false"
      />
      } @if (password.getError('maxlength')) {
      <p-messages
        [value]="[
          {
            severity: 'error',
            summary: 'validation error',
            detail: 'cannot exceed 10 char'
          }
        ]"
        [enableService]="false"
        [closable]="false"
      />
      } }
    </div>

    <p-button
      label="Login"
      [rounded]="true"
      class="w-80 text-center m-auto bg-blue-500 hover:bg-blue-700 py-3 px-8 rounded text-white font-semibold text-xl"
    />
  </form>
</div> -->

<div
  class="min-h-screen flex items-center justify-center bg-gradient-to-b from-slate-50 to-slate-100 py-8"
>
  <form
    [formGroup]="loginForm"
    (ngSubmit)="submit()"
    class="w-full max-w-md bg-white p-6 sm:p-8 rounded-2xl shadow-lg rtl"
    dir="rtl"
    aria-labelledby="loginTitle"
  >
    <h1
      id="loginTitle"
      class="text-center text-2xl sm:text-3xl font-extrabold text-slate-800 mb-6"
    >
      تسجيل الدخول
    </h1>

    <!-- currentPassword -->
    <div class="mb-3">
      <label
        for="currentPassword"
        class="block text-sm font-medium text-slate-700 mb-2"
        >كلمة السر الحالية</label
      >
      <p-inputGroup class="w-full">
        <p-inputGroupAddon
          class="bg-blue-50 border border-blue-200 rounded-l-md p-2"
        >
          <i class="pi pi-lock text-slate-600 text-2xl"></i>
        </p-inputGroupAddon>
        <input
          id="currentPassword"
          pPassword
          type="password"
          formControlName="currentPassword"
          placeholder="أدخل كلمة السر الحالية"
          class="w-full rounded-r-md p-3 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-300 text-base"
          aria-describedby="currentPasswordError"
          [ngClass]="{
            'bg-green-200 border-green-500':
              currentPassword.valid &&
              (currentPassword.dirty || currentPassword.touched),
            'bg-red-200 border-red-500':
              currentPassword.invalid &&
              (currentPassword.dirty || currentPassword.touched)
          }"
         #currentPasswordInput/>
        <p-inputGroupAddon
          class="bg-gray-50 border border-blue-200 rounded-l-md p-2"
        >
        <button type="button"
            class="p-0"
            (click)="togglePassword('currentPassword')"
            [attr.aria-pressed]="visibility['currentPassword'] ? true : false"
            title="Toggle password visibility"
            >
            <i
                [hidden]="visibility['currentPassword']"
                class="pi pi-eye text-slate-600 text-2xl"
            ></i>
            <i
                [hidden]="!visibility['currentPassword']"
                class="pi pi-eye-slash text-slate-600 text-2xl"
            ></i>
        </button> 
        </p-inputGroupAddon>
      </p-inputGroup>

      <!-- messages -->
      @if (currentPassword.touched || currentPassword.dirty) {

      <div class="mt-3">
        @if (currentPassword.hasError('required')) {
        <p-messages
          [value]="[
            { severity: 'error', summary: 'خطأ', detail: 'كلمة المرور مطلوبة' }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        }  @if (newPassword.hasError('minlength')) {
        <p-messages
          [value]="[
            {
              severity: 'error',
              summary: 'خطأ',
              detail: 'يجب ألا تقل كلمة السر عن 6 أحرف'
            }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        }
      </div>
      }
    </div>

    <!-- newPassword -->
    <div class="mb-4">
      <label
        for="newPassword"
        class="block text-sm font-medium text-slate-700 mb-2"
        >كلمة السر الجديدة</label
      >

      <p-inputGroup class="w-full">
        <p-inputGroupAddon
          class="bg-blue-50 border border-blue-200 rounded-l-md p-2"
        >
          <i class="pi pi-lock text-slate-600 text-2xl"></i>
        </p-inputGroupAddon>
        <input
          pPassword
          type="password"
          id="newPassword"
          formControlName="newPassword"
          placeholder="أدخل كلمة المرور الجديدة"
          class="w-9/12 p-3 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-300 text-base"
          aria-describedby="newPasswordError"
          [ngClass]="{
            'bg-green-200 border-green-500':
              newPassword.valid && (newPassword.dirty || newPassword.touched),
            'bg-red-200 border-red-500':
              newPassword.invalid && (newPassword.dirty || newPassword.touched)
          }"
          #newPasswordInput
        />
        <p-inputGroupAddon
          class="bg-gray-50 border border-blue-200 rounded-l-md p-2"
        >
          <button
            type="button"
            class="p-0"
            (click)="togglePassword('newPassword')"
            title="Toggle password visibility"
            >
          <i
            [hidden]="visibility['newPassword']"
            class="pi pi-eye text-slate-600 text-2xl"
          ></i>
          <i
            [hidden]="!visibility['newPassword']"
            class="pi pi-eye-slash text-slate-600 text-2xl"
          ></i>
          </button>
        </p-inputGroupAddon>
      </p-inputGroup>

      @if (newPassword.touched || newPassword.dirty) {

      <div class="mt-3">
        @if (newPassword.hasError('required')) {
        <p-messages
          [value]="[
            { severity: 'error', summary: 'خطأ', detail: 'كلمة السر مطلوبة' }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        } @if (newPassword.hasError('minlength')) {
        <p-messages
          [value]="[
            {
              severity: 'error',
              summary: 'خطأ',
              detail: 'يجب ألا تقل كلمة السر عن 6 أحرف'
            }
          ]"
          [enableService]="false"
          [closable]="false"
        ></p-messages>
        }
      </div>
      }
    </div>

    <div class="flex justify-center mt-6">
      <p-button
        type="submit"
        label="تغيير كلمة السر"
        [disabled]="loginForm.invalid"
        class="w-full sm:w-auto bg-gradient-to-r from-indigo-600 to-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:shadow-lg transition"
      ></p-button>
    </div>
  </form>
</div>
